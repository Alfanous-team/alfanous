{% extends "base.html" %}

{% load custom_filters %}
{% load kwacros %}


{% kwacro paginationRoutine %}
	{% block pagination %} {% endblock %}
    {% block pagination_tablet %} {% endblock %}
    {% block pagination_phone %} {% endblock %}
{% endkwacro %}

{% block results %}
	<div id="#search_result_static" class="row span9 offset2 text-center">			
		{% if results.error.code == 0  %}
			 <span	class="muted">
			 {{ _("Runtime") }} 
						({{ results.search.runtime|floatformat:"5" }} {{ _("seconds") }})
			 </span>
			
			{% if results.search.interval.total %}
				<!-- translation results -->
				<div class="row offset1 span10 text-center">
					<ul class="breadcrumb">
					    <li>{{ _("Results") }}: ( {{ results.search.interval.start }}</li>
					    <li>{{ _("to") }} {{ results.search.interval.end }}</li>
					    <li class="active">{{ _("of") }} {{ results.search.interval.total }}</li>
					    <li>)</li>
				    </ul>
				</div>
					
				<!-- Pages control # top one -->
				<div class="row">
					<div class="span12">
						{% usekwacro paginationRoutine %}
					</div>
				</div>
				
				{% for translationresult_id, translationresult_content in  	results.search.translations.items %}
					<div class='container well well-small span12'>
					    <fieldset class='main_re_item'>
					    	<legend class="text-left">
						    	<span class="muted">
						      	<span class="hidden-phone">{{ _("Result nÂ°") }} </span>
						      	
						      	 <b> <span class="visible-phone">#</span>{{ translationresult_id }} </b> 
						      	   
						    	</span>
						    	  <div class="btn-group pull-right">
				                            <button class="btn"><i class="icon-file"></i></button>
				                            <button class="btn"><i class="icon-share"></i></button>
				                        </div>
				  			</legend>
				  			<div class="row-fluid">
			                    <div class="span10 offset1">
				                    <div class="row">
				                        <div id="aya_text_{{ ayaresult_id }}" class="row text-center non-arabic-ayah">
				                        		[
												{% for translation_word in translationresult_content.text|space_split %}
													{% spaceless %}
														{% autoescape off %}
															{% if translation_word|first in "<ct> "|make_list  %}
																{{ translation_word }} 
															{% else %} 
																<a href="?{% build_search_link params translation_word 1 False %}"> {{ translation_word }}</a> 
															{% endif %}
														{% endautoescape%}
													{% endspaceless %}	
											  	{% endfor %}
							  					]
							  						
							  				
																					
				                        </div>
				              
		
				                    </div>
			                    </div>
			                    
			                    <div class="row text-center span12">
			                    	<hr/>
			                 		{% if translationresult_content.aya %}

								  		<p class="arabic-ayah">
									  		<span class='quran_decoration main_aya'>
									 		 [ </span>
									  		<span class="aya_words quran main_aya">
									  		  {{ translationresult_content.aya.text }} 
									  		</span>
									  		<span class='quran_decoration main_aya'>
									  		] </span>									  		
									  	
											-	 {% with translationresult_content.aya.aya_id|stringformat:"s" as aya_id %}
													 {% with bidi.fields.sura|add:':"'|add:translationresult_content.aya.sura_name|add:'" + '|add:bidi.fields.aya_id|add:':'|add:aya_id|urlencode  as new_query %}
														<a class="text-success" href='{% url alfanous-django.wui.views.results current.language "aya" %}?{% build_search_link params  new_query 1 False %}'> 
													{% endwith %}
												{% endwith %}
												<small>{{ translationresult_content.aya.sura_name }}</small> {{ translationresult_content.aya.aya_id }} </a> 

								  		</p>
						  			{% endif %}
				                		</div>
				                		
				                		<div class="row text-center span12">
				                		   <hr/>
											<span class="badge badge-info">{{ _("About translation") }}</span>
															<span class="label label-success" >
										  					 {% with translationresult_content.identifier.gid|stringformat:"s" as translation_gid %}
																	{% with "gid:"|add:translation_gid|add:" AND lang:"|add:translationresult_content.info.language as new_query %}
																			<a  href='?{% build_search_link params  new_query 1 False %}'> 
																	{% endwith %}
																{% endwith %}
														    	{{ _("Aya") }} | {{ translationresult_content.identifier.gid }}
							  							   </span></a>
										
												    		<span class="label label-success">
																{% with "author:"|add:translationresult_content.info.author as new_query %}
																	<a href='?{% build_search_link params  new_query 1 True %}'> 
																{% endwith %} 
																	{{ _("Author") }} | {{  translationresult_content.info.author }} </a>
															</span>
															<span class="label label-inverse">
																{% with "lang:"|add:translationresult_content.info.language as new_query %}
																	<a href='?{% build_search_link params  new_query 1 True %}'> 
																{% endwith %} 
																{{ _("Language") }} | {{ translationresult_content.info.language }}</a>
															</span>
										
				                        </div>
				  			</div>
					    </fieldset>
					</div>
				{% endfor %}
					
				<!-- Pages control # bottom one -->
				<div class="row">
					<div class="span12">
						{% usekwacro paginationRoutine %}
					</div>
				</div>
			</div>
	</div>
			{% else %}
				<div class="row">
					<div class="alert alert-error text-center span12">
						<button type="button" class="close" data-dismiss="alert">&times;</button>
						{{ _("Sorry! there is no results for this search query.") }}
					</div>
				</div>
			{% endif %}			
		{% elif results.error %}
			<div class="row">
				<div class="alert alert-error span12">
					<button type="button" class="close" data-dismiss="alert">&times;</button>
					{{ _("Error ") }} ({{ results.error.code }}) : {{ results.error.msg|linebreaksbr }}
				</div>
			</div>
		{% else %}
			
		{% endif %}
{% endblock results %}